let startY=0;$(document).ready(()=>{window.addEventListener("resize",_),$(".modal_wrap").css("display","none"),setTimeout(()=>{$(".loading").remove(),$(".modal").toggleClass("hide"),$(".modal_wrap").css("display","")},1e3),[".event_banner",".event_gnb_menu"].forEach(e=>$(e).on("click",()=>{$(".event_banner").toggleClass("-open")})),$(".event_gnb_gamestart").on("click",()=>{window.open("https://galaxy.beanfun.com/webapi/view/login/twp?redirect_url=https://warsofprasia.beanfun.com/Main")}),$(".modal_close").on("click",()=>{$(".plate_modal").toggleClass("-active"),$(".modal.type--youtube").toggleClass("hide"),$(".modal_box_veil").toggleClass("-hide"),$(".modal").css("opacity","0"),$(".youtube--2").remove()}),$(".section_spec .content .sub_content .video .sourcebox .video_button").on("click",()=>{let e=document.querySelector(".section_spec .content .sub_content .video video");e.paused?(e.play(),$(".section_spec .content .sub_content .video").addClass("play")):e.pause()}),$(".section_hero .video_button").on("click",()=>openVideo("AHkz5TEwE-g")),$(".section_hero_sec .video_button").on("click",()=>openVideo("BjdvG4A2shg")),$(".toggle").on("click",e=>{$(e.target).parent().parent().hasClass("open")?$(e.target).parent().parent().removeClass("open"):$(e.target).parent().parent().addClass("open"),$(e.target).parent().parent().siblings().removeClass("open")});let e=!1,t=[{id:"map4",section:".section_map",startX:-270,startY:-1},{id:"map6",section:".section_story",startX:-686,startY:-175,canvasWidth:3240.89,canvasHeight:1823},{id:"map7",section:".section_place",startX:($(window).width()-2637)/2,startY:($(window).height()-1483)/2}],a={};t.forEach(({id:e,section:t,startX:s,startY:n,canvasWidth:i,canvasHeight:o})=>{let p=$(`${t} .map`),r=document.getElementById(e),c=r.getContext("2d"),l=new Image,m=$(`${t} .map_plate`);a[e]={mapContainer:p,canvas:r,ctx:c,img:l,plate:m,startX:s,startY:n,currentX:s,currentY:n,mapWidth:p[0].offsetWidth,mapHeight:p[0].offsetHeight,plateWidth:m[0].offsetWidth,plateHeight:m[0].offsetHeight,canvasWidth:i,canvasHeight:o}}),$(".type--fortress").on("click",()=>{$(".section_story .textbox").addClass("open"),$(".section_story .dimmed_bg").addClass("show"),$(".section_story .infoside").addClass("open"),769>$(window).width()&&($(".section_story .content .dimmed_bg.show").on("click",()=>{$(".section_story .textbox").removeClass("open"),$(".section_story .dimmed_bg").removeClass("show"),$(".section_story .infoside").removeClass("open")}),$(".section_story .infoside_wrap").on("touchmove",e=>{e.stopPropagation()}))}),$(".section_story .close button").on("click",()=>{$(".section_story .textbox").removeClass("open"),$(".section_story .dimmed_bg").removeClass("show"),$(".section_story .infoside").removeClass("open")}),$(".section_place .point").on("click",e=>{!e.currentTarget.classList.contains("not")&&($(".section_place .infoside_wrap").css("display","none"),$(".section_place .point").addClass("dimmed"),$(".section_place .dimmed_bg").addClass("show"),$(".section_place .infoside").addClass("open"),e.currentTarget.classList.remove("dimmed"),e.currentTarget.classList.contains("type_1")?$(".section_place .infoside_wrap.info_type_1").css("display","flex"):e.currentTarget.classList.contains("type_2")?$(".section_place .infoside_wrap.info_type_2").css("display","flex"):e.currentTarget.classList.contains("type_3")&&$(".section_place .infoside_wrap.info_type_3").css("display","flex"),769>$(window).width()&&($(".section_place .content>.dimmed_bg.show").on("click",()=>{$(".section_place .point").removeClass("dimmed"),$(".section_place .dimmed_bg").removeClass("show"),$(".section_place .infoside").removeClass("open"),$(".section_place .infoside_wrap").css("display","none"),a.map7.mapContainer.removeClass("mini")}),$(".section_place .infoside_wrap").on("touchmove",e=>{e.stopPropagation()})))}),$(".section_place .close button").on("click",()=>{a.map7.canvasWidth=2636.8,a.map7.canvasHeight=1483.2,a.map7.plate.css("width",`${a.map7.canvasWidth}px`),a.map7.plate.css("height",`${a.map7.canvasHeight}px`),a.map7.plateWidth=a.map7.plate[0].offsetWidth,a.map7.plateHeight=a.map7.plate[0].offsetHeight,a.map7.mapContainer.removeClass("mini"),$(".section_place .point").removeClass("dimmed"),$(".section_place .dimmed_bg").removeClass("show"),$(".section_place .infoside").removeClass("open"),$(".section_place .infoside_wrap").css("display","none");let e=$(".section_place .map_plate .point:not(.dimmed)");e.hasClass("type_1")?(a.map7.startY=-182,a.map7.currentY=-182,e.hasClass("key--1")?(a.map7.startX=-551,a.map7.currentX=-551):(a.map7.startX=-707,a.map7.currentX=-707)):e.hasClass("type_2")?(a.map7.startY=-81,a.map7.currentY=-81,e.hasClass("key--3")?(a.map7.startX=-533,a.map7.currentX=-533):(a.map7.startX=-725,a.map7.currentX=-725)):e.hasClass("type_3")&&(a.map7.startY=-66,a.map7.currentY=-66,e.hasClass("key--5")?(a.map7.startX=-393,a.map7.currentX=-393):(a.map7.startX=-852,a.map7.currentX=-852)),a.map7.plate.css("transform",`translate3d(${a.map7.currentX}px, ${a.map7.currentY}px, 0)`),v("map7")});let s,n,i;function o(e){return t=>handleSmallHeight(e,t)}function p(e){return t=>{911>$(window).height()?handleSmallHeight(e,t):e.allowTouchMove=!0}}let r,c,l;function m(e){startY=e.touches[0].clientY}function d(e){return t=>{t.stopPropagation();let a=e.slides[e.activeIndex],s=a.scrollTop,n=a.scrollHeight,i=a.clientHeight,o=0===s,p=s+i>=n;0===e.realIndex?p&&t.deltaY>0&&e.slideTo(e.realIndex+1):[1,2,3,4,5,6].includes(e.realIndex)?o&&t.deltaY<0?e.slideTo(e.realIndex-1):p&&t.deltaY>0&&e.slideTo(e.realIndex+1):o&&t.deltaY<0&&e.slideTo(e.realIndex-1)}}let h=()=>{s=new Swiper(".section-pages",{direction:"vertical",touchReleaseOnEdges:!0,mousewheel:{releaseOnEdges:!0},loop:!1,freeMode:!1,noSwiping:!0,noSwipingSelector:"button",autoHeight:!0,speed:1e3,slidesPerView:1,spaceBetween:0,allowTouchMove:!1,on:{init(e){r=p(e),c=o(e),l=d(e),$(".UNI-footer").clone().appendTo(".section_soon"),$(".UNI-footer")[1]?.remove(),$(".UNI-footer").css("z-index",100).css("position","absolute").css("width","100%").css("height",80),$(".gotop").on("click",()=>{e.slideTo(0),e.slides.forEach(e=>{e.scrollTop=0})}),$(".UNI-footer").css("display","none"),$(".section_hero .scroll").on("click",()=>{e.slideTo(1)}),$(".section_hero_sec .scroll").on("click",()=>{e.slideTo(5)}),document.querySelectorAll(".swiper-slide-page").forEach(e=>{e.children[0].classList.contains("section_spec")&&1280>=$(window).width()&&e.addEventListener("touchmove",c,{passive:!0}),e.addEventListener("wheel",l,{passive:!0}),e.children[0].classList.contains("section_spec")||e.addEventListener("touchmove",r,{passive:!0}),e.addEventListener("touchstart",m,{passive:!0})})},slideChange(e){a.map7.mapContainer.removeClass("mini"),$(".section_story .textbox").removeClass("open"),$(".section_story .dimmed_bg").removeClass("show"),$(".section_story .infoside").removeClass("open"),$(".section_place .point").removeClass("dimmed"),$(".section_place .dimmed_bg").removeClass("show"),$(".section_place .infoside").removeClass("open"),$(".section_place .infoside_wrap").css("display","none"),["active","point"].forEach(e=>[".depth_1",".depth_2"].forEach(t=>$(t).removeClass(e))),$(".swiper-slide-page").off("scroll"),$(".swiper-slide-page").removeClass("scrollable"),$(".gotop").removeClass("show"),$(".UNI-footer").css("display","none"),$(".swiper-slide-page")[e.realIndex].classList.add("scrollable"),$(".depth_1")[e.realIndex].classList.add("active"),$(".depth_1")[e.realIndex].classList.add("point"),0!==e.realIndex&&$(".gotop").addClass("show"),6===e.realIndex&&(a.map7.canvasWidth=2636.8,a.map7.canvasHeight=1483.2,a.map7.plate.css("width",`${a.map7.canvasWidth}px`),a.map7.plate.css("height",`${a.map7.canvasHeight}px`),a.map7.plateWidth=a.map7.plate[0].offsetWidth,a.map7.plateHeight=a.map7.plate[0].offsetHeight,a.map7.startX=($(window).width()-2637)/2,a.map7.startY=($(window).height()-1483)/2,a.map7.currentX=($(window).width()-2637)/2,a.map7.currentY=($(window).height()-1483)/2,a.map7.plate.css("transform",`translate3d(${a.map7.startX}px, ${a.map7.startY}px, 0)`),v("map7")),7===e.realIndex&&$(".UNI-footer").css("display","block")}}}),$(".swiper-slide-page")[0].classList.add("scrollable"),s.slideTo(0),$(".depth_1")[0].classList.add("active"),$(".depth_1")[0].classList.add("point");for(let e=0;e<8;e++)addPageClick(e,s)},g=()=>{i=new Swiper(".section-group-pages",{touchReleaseOnEdges:!0,mousewheel:{releaseOnEdges:!0},loop:!1,slideActiveClass:"animated",noSwiping:!0,noSwipingSelector:"button",autoHeight:!0,speed:1e3,slidesPerView:1,spaceBetween:0,allowTouchMove:!0,on:{slideChange(e){$(window).width()>768?e.realIndex>0&&e.slideTo(0):e.realIndex>1&&e.slideTo(1)}}})},u=()=>{n=new Swiper(".section-pages",{direction:"vertical",slidesPerView:"auto",touchReleaseOnEdges:!0,mousewheel:{releaseOnEdges:!0,enabled:!1},loop:!1,freeMode:{enabled:!0,sticky:!1,momentumBounce:!1},autoHeight:!0,speed:0,passiveListeners:!0,allowTouchMove:!0,on:{init(e){$(".gotop").on("click",()=>{e.slideTo(0)}),$(".section_hero .scroll").on("click",()=>{e.slideTo(1)}),$(".section_hero_sec .scroll").on("click",()=>{e.slideTo(5)}),$(".UNI-footer").css("display","none")},slideChange(e){$(".section_story .textbox").removeClass("open"),$(".section_story .dimmed_bg").removeClass("show"),$(".section_story .infoside").removeClass("open"),$(".gotop").removeClass("show"),$(".UNI-footer").css("display","none"),0!==e.realIndex&&$(".gotop").addClass("show"),7===e.realIndex&&$(".UNI-footer").css("display","block")}}})};function v(e){let t=a[e];if(!t)return;let{ctx:s,canvas:n,img:i,currentX:o,currentY:p,canvasWidth:r,canvasHeight:c}=t;s.clearRect(0,0,n.width,n.height),s.drawImage(i,o,p,r,c),i.onload=()=>{s.drawImage(i,o,p,r,c)}}function f(){a.map4.canvasWidth=2603.8,a.map4.canvasHeight=1269,a.map4.canvas.width=$(window).width(),a.map4.canvas.height=1268,a.map4.currentX=-824+($(window).width()-820)/2,a.map4.startX=a.map4.currentX,a.map4.plate.css("transform",`translate3d(${a.map4.currentX}px, ${a.map4.currentY}px, 0)`),a.map6.canvas.width=$(window).width(),a.map6.canvas.height=$(window).height(),a.map6.currentX=-970+($(window).width()-820)/2,a.map6.startX=a.map6.currentX,a.map6.currentY=-42+($(window).height()-1180)/2,a.map6.startY=a.map6.currentY,a.map6.plate.css("transform",`translate3d(${a.map6.currentX}px, ${a.map6.currentY}px, 0)`),a.map7.canvas.width=$(window).width(),a.map7.canvas.height=$(window).height(),v("map4"),v("map6"),v("map7"),["map4","map6","map7"].forEach(function t(s){let n=a[s];n.mapContainer.on("mousedown touchstart",t=>{e=!0;let a=void 0!==t.clientX?t.clientX:t.targetTouches[0].clientX,s=void 0!==t.clientY?t.clientY:t.targetTouches[0].clientY;n.startX=a-n.currentX,n.startY=s-n.currentY,n.mapContainer.css("cursor","grabbing")}),n.mapContainer.on("mousemove touchmove",t=>{if(!e)return;let a=void 0!==t.clientX?t.clientX:t.targetTouches[0].clientX,i=void 0!==t.clientY?t.clientY:t.targetTouches[0].clientY,o=a-n.startX,p=i-n.startY;if(n.plateWidth>n.mapWidth){let r=n.mapWidth-n.plateWidth;o=Math.max(r,Math.min(0,o))}else o=0;if(n.plateHeight>n.mapHeight){let c=n.mapHeight-n.plateHeight;p=Math.max(c,Math.min(0,p))}else p=0;n.currentX=o,n.currentY=p,n.plate.css("transform",`translate3d(${n.currentX}px, ${n.currentY}px, 0)`),v(s)}),n.mapContainer.on("mouseup touchend",()=>{e=!1,n.mapContainer.css("cursor","grab")})}),$(".section_place button:not(.not)").on("click",e=>{e.currentTarget.classList.contains("type_1")?(a.map7.startY=-437,a.map7.currentY=-437,e.currentTarget.classList.contains("key--1")?(a.map7.startX=-1042,a.map7.currentX=-1042):(a.map7.startX=-1259,a.map7.currentX=-1259)):e.currentTarget.classList.contains("type_2")?(a.map7.startY=-296,a.map7.currentY=-296,e.currentTarget.classList.contains("key--3")?(a.map7.startX=-1016,a.map7.currentX=-1016):(a.map7.startX=-1285,a.map7.currentX=-1285)):e.currentTarget.classList.contains("type_3")&&(a.map7.startY=-275,a.map7.currentY=-275,e.currentTarget.classList.contains("key--5")?(a.map7.startX=-820,a.map7.currentX=-820):(a.map7.startX=-1462,a.map7.currentX=-1462)),e.currentTarget.classList.length>0&&(a.map7.mapContainer.addClass("mini"),a.map7.plate.css("transform",`translate3d(${a.map7.currentX}px, ${a.map7.currentY}px, 0)`),a.map7.canvasWidth=3692.52,a.map7.canvasHeight=2076.48,a.map7.plate.css("width",`${a.map7.canvasWidth}px`),a.map7.plate.css("height",`${a.map7.canvasHeight}px`),v("map7"),a.map7.plateWidth=a.map7.plate[0].offsetWidth,a.map7.plateHeight=a.map7.plate[0].offsetHeight)})}a.map4.img.src="img/page4/p4_bg.webp",$(window).width()>768?(a.map6.img.src="img/page6/p6_bg.webp",a.map7.img.src="img/page7/p7_bg.webp",f(),$(".event_gnb").addClass("type_clear"),$(".event_gnb").removeClass("type_default"),h()):(a.map4.currentX=-470+($(window).width()-375)/2,a.map4.currentY=-121,a.map4.canvasWidth=1868.8,a.map4.canvasHeight=911.04,a.map4.canvas.width=$(window).width(),a.map4.canvas.height=670,a.map4.plate.css("width",`${a.map4.canvasWidth}px`).css("height",`${a.map4.canvasHeight}px`),a.map4.plate.css("transform",`translate3d(${a.map4.currentX}px, ${a.map4.currentY}px, 0px)`),v("map4"),a.map6.currentX=-1147+($(window).width()-375)/2,a.map6.currentY=-234+($(window).height()-675)/2,a.map6.plate.css("transform",`translate3d(${a.map6.currentX}px, ${a.map6.currentY}px, 0px)`),$(".section_place button:not(.not)").on("click",e=>{e.currentTarget.classList.length>0&&a.map7.mapContainer.addClass("mini")}),$(".event_gnb").addClass("type_default"),$(".event_gnb").removeClass("type_clear"),u()),g();let w=$(window).width(),y=$(window).height();function _(){let e=document.documentElement,t=window.innerHeight+"px";if(e.style.setProperty("--maxvh",t),i?i.update():setTimeout(()=>g()),$(window).width()>768){$(".event_gnb").addClass("type_clear"),$(".event_gnb").removeClass("type_default"),n&&(n.destroy(!0,!0),n=null),s?s.update():setTimeout(()=>h()),a.map4.canvas.width=$(window).width(),a.map4.canvas.height=1268,a.map4.canvasWidth=2603.8,a.map4.canvasHeight=1269,a.map4.plate.css("width",`${a.map4.canvasWidth}px`),a.map4.plate.css("height",`${a.map4.canvasHeight}px`),a.map4.mapWidth=a.map4.mapContainer[0].offsetWidth,a.map4.mapHeight=a.map4.mapContainer[0].offsetHeight,a.map4.plateWidth=a.map4.plate[0].offsetWidth,a.map4.plateHeight=a.map4.plate[0].offsetHeight,a.map4.currentX+=($(window).width()-w)/2,a.map4.currentY+=($(window).height()-y)/2;let o=a.map4.mapWidth-a.map4.plateWidth,p=a.map4.mapHeight-a.map4.plateHeight;a.map4.currentX=Math.max(o,Math.min(0,a.map4.currentX)),a.map4.currentY=Math.max(p,Math.min(0,a.map4.currentY)),a.map4.plate.css("transform",`translate3d(${a.map4.currentX}px, ${a.map4.currentY}px, 0)`),v("map4"),a.map6.canvas.width=$(window).width(),a.map6.canvas.height=$(window).height(),a.map6.mapWidth=a.map6.mapContainer[0].offsetWidth,a.map6.mapHeight=a.map6.mapContainer[0].offsetHeight,a.map6.plateWidth=a.map6.plate[0].offsetWidth,a.map6.plateHeight=a.map6.plate[0].offsetHeight,a.map6.currentX+=($(window).width()-w)/2,a.map6.currentY+=($(window).height()-y)/2,o=a.map6.mapWidth-a.map6.plateWidth,p=a.map6.mapHeight-a.map6.plateHeight,a.map6.currentX=Math.max(o,Math.min(0,a.map6.currentX)),a.map6.currentY=Math.max(p,Math.min(0,a.map6.currentY)),a.map6.plate.css("transform",`translate3d(${a.map6.currentX}px, ${a.map6.currentY}px, 0)`),v("map6"),a.map7.canvas.width=$(window).width(),a.map7.canvas.height=$(window).height(),a.map7.mapWidth=a.map7.mapContainer[0].offsetWidth,a.map7.mapHeight=a.map7.mapContainer[0].offsetHeight,a.map7.plateWidth=a.map7.plate[0].offsetWidth,a.map7.plateHeight=a.map7.plate[0].offsetHeight,a.map7.currentX+=($(window).width()-w)/2,a.map7.currentY+=($(window).height()-y)/2,p=a.map7.mapHeight-a.map7.plateHeight,o=a.map7.mapWidth-a.map7.plateWidth,a.map7.currentX=Math.max(o,Math.min(0,a.map7.currentX)),a.map7.currentY=Math.max(p,Math.min(0,a.map7.currentY)),a.map7.plate.css("transform",`translate3d(${a.map7.currentX}px, ${a.map7.currentY}px, 0)`),v("map7"),w=$(window).width(),y=$(window).height(),w<=768&&f()}else s&&(s.destroy(!0,!0),s=null,document.querySelectorAll(".swiper-slide-page").forEach(e=>{e.children[0].classList.contains("section_spec")&&1280>=$(window).width()&&e.removeEventListener("touchmove",c,{passive:!0}),e.removeEventListener("wheel",l,{passive:!0}),e.children[0].classList.contains("section_spec")||e.removeEventListener("touchmove",r,{passive:!0}),e.removeEventListener("touchstart",m,{passive:!0})})),a.map4.canvas.width=$(window).width(),a.map4.canvas.height=670,a.map4.currentX=-470+($(window).width()-375)/2,a.map4.currentY=-121,a.map4.plate.css("transform",`translate3d(${a.map4.currentX}px, ${a.map4.currentY}px, 0px)`),v("map4"),a.map6.currentX=-1147+($(window).width()-375)/2,a.map6.currentY=-234+($(window).height()-675)/2,a.map6.plate.css("transform",`translate3d(${a.map6.currentX}px, ${a.map6.currentY}px, 0px)`),$(".event_gnb").addClass("type_default"),$(".event_gnb").removeClass("type_clear"),n?n.update():setTimeout(()=>u())}});const handleSmallHeight=(e,t)=>{e.allowTouchMove=!0,t.stopPropagation();let a=t.touches[0].clientY,s="";a>startY?s="down":a<startY&&(s="up");let n=e.slides[e.activeIndex],i=n.scrollTop,o=n.scrollHeight,p=n.clientHeight,r=0===i,c=i+p>=o;r?0!==e.realIndex&&"down"===s&&e.slideTo(e.realIndex-1):c&&"up"===s&&e.slideTo(e.realIndex+1)},addPageClick=(e,t)=>{$(`.page_p${e+1}`).on("click",()=>{t.slideTo(e)})},openVideo=(e,t)=>{$(".plate_modal").toggleClass("-active"),$(".modal").css("opacity","1").css("visibility","inherit"),$(".modal.type--youtube").toggleClass("hide"),$(".modal_box_veil").toggleClass("-hide"),e?$(".modal_source").append(`<iframe width="auto" height="auto" class="modal_youtube youtube--2"
        src="https://www.youtube.com/embed/${e}?si=1_stAmmA1RL7LFrt"
            frameborder="0" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            referrerpolicy="strict-origin-when-cross-origin"
            allowfullscreen></iframe>`):t&&$(".modal_source").append(`<video class="modal_youtube youtube--2" loop autoplay playsinline controls controlslist="nodownload" preload="metadata"><source src=${t} type="video/mp4"></video>`)};